Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(City == "Janesville")
df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(City == "Janesville") %>% View()
df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Janesville") %>% View()
df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Janesville") %>% View()
CT_Janesville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Janesville")
CT_Beloit <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Beloit")
View(CT_Beloit)
View(CT_Janesville)
View(CT_Beloit)
View(CT_Janesville)
CT_Clinton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Clinton")
CT_Edgerton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Edgerton")
CT_Evansville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Evansville")
CT_Milton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Milton")
CT_Brodhead <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Brodhead")
CT_Hanover <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Hanover")
CT_Footville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Footville")
CT_Orfordville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Orfordville")
CT_Avalon <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "CT",
City == "Avalon")
write.csv(CT_Janesville, "CT_Janesville.csv")
write.csv(CT_Janesville, "CT_Janesville.csv")
write.csv(CT_Beloit, "CT_Beloit.csv")
write.csv(CT_Avalon, "CT_Avalon.csv")
write.csv(CT_Brodhead, "CT_Brodhead.csv")
write.csv(CT_Clinton, "CT_Clinton.csv")
write.csv(CT_Edgerton, "CT_Edgerton.csv")
write.csv(CT_Evansville, "CT_Evansville.csv")
write.csv(CT_Footville, "CT_Footville.csv")
write.csv(CT_Hanover, "CT_Hanover.csv")
write.csv(CT_Milton, "CT_Milton.csv")
write.csv(CT_Orfordville, "CT_Orfordville.csv")
# ---------- #
# Export GCs #
# ---------- #
GC_Janesville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Janesville")
GC_Beloit <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Beloit")
GC_Clinton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Clinton")
GC_Edgerton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Edgerton")
GC_Evansville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Evansville")
GC_Milton <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Milton")
GC_Brodhead <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Brodhead")
GC_Hanover <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Hanover")
GC_Footville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Footville")
GC_Orfordville <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Orfordville")
GC_Avalon <- df_Locations11 %>%
mutate(AgeGroup = case_when(
Age <= 17 ~ "0-17",
Age >= 18 & Age < 25 ~"18-24",
Age >= 25 & Age < 35 ~"25-34",
Age >= 35 & Age < 45 ~"35-44",
Age >= 45 & Age < 55 ~"45-54",
Age >= 55 & Age < 65 ~"55-64",
Age >= 65 ~"65+")) %>%
group_by(AgeGroup, City, Disease) %>%
summarise(Count = n()) %>%
filter(Disease == "GC",
City == "Avalon")
write.csv(GC_Janesville, "GC_Janesville.csv")
write.csv(GC_Beloit, "GC_Beloit.csv")
write.csv(GC_Avalon, "GC_Avalon.csv")
write.csv(GC_Brodhead, "GC_Brodhead.csv")
write.csv(GC_Clinton, "GC_Clinton.csv")
write.csv(GC_Edgerton, "GC_Edgerton.csv")
write.csv(GC_Evansville, "GC_Evansville.csv")
write.csv(GC_Footville, "GC_Footville.csv")
write.csv(GC_Hanover, "GC_Hanover.csv")
write.csv(GC_Milton, "GC_Milton.csv")
write.csv(GC_Orfordville, "GC_Orfordville.csv")
View(df_facility)
# Line Plot
# Using simulated data
library(dplyr)
library(lubridate)
# The original data inputs:
savings <- monthly_savings(input$monthly_income, input$expenses)
# Recreate monthly savings given some number
start_date <- as.Date("2020-01-01")
end_date <- as.Date("2025-12-31")
monthly_income <-  3000
monthly_expenses <- 1500
current_savings <- 10000
Date <- seq.Date(from = start_date, to = end_date, by = 1)
df <- ""
df$date <- seq.Date(from = start_date, to = end_date, by = 1)
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = seq(1, length(month)),
test = month*(current_savings + (monthly_income - monthly_expenses)))
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = seq(1, length(month)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = rep(seq(1, length(month), 12)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
rep(1, 12)
?seq()
rep(1, 12)
seq(1, length.out = 12)
seq(rep(1, 12), length.out = 12)
seq(from = rep(1, 12), length.out = 12)
rep(seq(rep(1, 12), length.out = 12), 1)
rep(1:12, length(df$date))
rep(rep(1, 12), length(df$date))
rep(rep(1:12, 12), length(df$date))
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = rep(rep(1:12, 12), length(df$date)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = rep(rep(1:12, 12), length(df$date)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = rep(rep(1:12, 12), length(month)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings,
month_tally = rep(rep(1:12, 12), length(df$date)),
test = month*(current_savings + (monthly_income - monthly_expenses))) %>% View()
length(df$date)
rep(rep(1:12, 12), length(df$date))
rep(1, length(df$date))
rep(1, 12)
data.frame(df)
data.frame(df) %>%
mutate(month = lubridate::month(date))
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings)
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings)
data.frame(df) %>%
mutate(month = lubridate::month(date),
current_savings = current_savings) %>%
group_by(month) %>%
summarise(Count = n())
setwd("C:/Users/Zachary.Palmore/GitHub/Home/home_afford_app")
create_savingsdf <- function(init_savings, savings, start_date, end_date) {
# initialize total_savings to init_savings
total_savings <- init_savings
# create df with column for savings
df = data.frame(
Savings = c(total_savings)
)
# calculate num_months
num_months <- months_passed(start_date, end_date)
# add savings to total_savings for num_months
while (num_months > 0) {
total_savings <- total_savings + savings
num_months <- num_months - 1
df = rbind(df, total_savings)
}
# add column for dates
Date <- seq(as.Date(start_date), as.Date(end_date), by="month")
df <- cbind(Date, df)
return(df)
}
# Calculate monthly savings
monthly_savings <- function(income, expenses) {
savings <- income - expenses
return(savings)
}
# setwd("C:/Users/Zachary.Palmore/GitHub/Home/home_afford_app")
source(helper.R)
# setwd("C:/Users/Zachary.Palmore/GitHub/Home/home_afford_app")
source("helper.R")
create_savingsdf(init_savings = current_savings,
savings = monthly_income - monthly_expenses,
start_date = start_date, end_date = end_date)
df <- create_savingsdf(init_savings = current_savings,
savings = monthly_income - monthly_expenses,
start_date = start_date, end_date = end_date)
View(df)
mean(df$Savings)
calculate_savings(current_savings, savings = monthly_income - monthly_expenses,
start_date = start_date, end_date = end_date)
monthly_income - monthly_expenses
rnorm(100, mean = monthly_income - monthly_expenses, sd = 1)
rnorm(100, mean = monthly_income - monthly_expenses, sd = 400)
df$Points <- rnorm(72, mean = monthly_income - monthly_expenses, sd = 400) # Insert realistic standard deviation
plot(df$Date, df$Points)
plot(df$Date, df$Savings)
plot(df$Date, df$Points)
df %>%
mutate(cumsum(Points))
df %>%
mutate(Theory_Savings = cumsum(Points))
df <- df %>% mutate(Theory_Savings = cumsum(Points))
plot(df$Date, df$Theory_Savings)
df$Points <- rnorm(72, mean = monthly_income - monthly_expenses, sd = 800) # Insert realistic standard deviation
df <- df %>% mutate(Theory_Savings = cumsum(Points))
plot(df$Date, df$Theory_Savings)
df$Points <- rnorm(72, mean = monthly_income - monthly_expenses, sd = 1200) # Insert realistic standard deviation
df <- df %>% mutate(Theory_Savings = cumsum(Points))
plot(df$Date, df$Theory_Savings)
df$Points <- rnorm(72, mean = monthly_income - monthly_expenses, sd = 1500) # Insert realistic standard deviation
df <- df %>% mutate(Theory_Savings = cumsum(Points))
plot(df$Date, df$Theory_Savings)
df$Points <- rnorm(72, mean = monthly_income - monthly_expenses, sd = 1700) # Insert realistic standard deviation
df <- df %>% mutate(Theory_Savings = cumsum(Points))
plot(df$Date, df$Theory_Savings)
plot(df$Date, df$Theory_Savings) + abline()
plot(df$Date, df$Theory_Savings) + abline()
plot(df$Date, df$Theory_Savings)
abline
plot(df$Date, df$Theory_Savings)
abline()
library(ggplot2)
ggplot(df, aes(Date, Theory_Savings)) + geom_point()
ggplot(df, aes(Date, Theory_Savings)) + geom_point() + geom_smooth()
ggplot(df, aes(Date, Theory_Savings)) + geom_point() + geom_smooth(method = "lm")
